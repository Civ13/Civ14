- type: entity
  id: BaseGameRule
  abstract: true
  components:
    - type: GameRule

- type: entity
  parent: BaseGameRule
  id: RespawnDeadRule
  components:
    - type: RespawnDeadRule
      alwaysRespawnDead: true
    - type: RespawnTracker
      respawnDelay: 10
      deleteBody: false

- type: entity
  parent: BaseGameRule
  id: DummyNonAntagChance
  components:
    - type: SubGamemodes
      rules:
        - id: DummyNonAntag
          prob: 0.3

- type: entity
  id: InactivityTimeRestart
  parent: BaseGameRule
  components:
    - type: InactivityRule
      inactivityMaxTime: 600
      roundEndDelay: 10

- type: entity
  id: MaxTimeRestart
  parent: BaseGameRule
  components:
    - type: MaxTimeRestartRule
      roundMaxTime: 300
      roundEndDelay: 10

- type: entity
  id: Sandbox
  parent: BaseGameRule
  components:
    - type: SandboxRule

- type: entity
  id: Secret
  parent: BaseGameRule
  components:
    - type: SecretRule

# This rule makes the chosen players unable to get other antag rules, as a way to prevent metagaming job rolls.
# Put this before antags assigned to station jobs, but after non-job antags (NukeOps/Wiz).
- type: entity
  id: DummyNonAntag
  parent: BaseGameRule
  components:
    - type: GameRule
      minPlayers: 5
    - type: AntagSelection
      selectionTime: IntraPlayerSpawn # Pre-selection before jobs; assignment doesn't really matter though, we only care about the pre-selection to block other antags.
      removeUponFailedSpawn: false
      definitions:
        - prefRoles: [InitialInfected, Traitor, Thief, HeadRev]
          max: 2
          playerRatio: 30

# event schedulers

- type: entityTable
  id: BasicGameRulesTable
  table:
    !type:AllSelector # we need to pass a list of rules, since rules have further restrictions to consider via StationEventComp
    children:
      - !type:NestedSelector
        tableId: BasicCalmEventsTable
      - !type:NestedSelector
        tableId: BasicAntagEventsTable
      - !type:NestedSelector
        tableId: CargoGiftsTable
      - !type:NestedSelector
        tableId: CalmPestEventsTable
      - !type:NestedSelector
        tableId: SpicyPestEventsTable

- type: entity
  id: BasicStationEventScheduler
  parent: BaseGameRule
  components:
    - type: BasicStationEventScheduler
      scheduledGameRules: !type:NestedSelector
        tableId: BasicGameRulesTable

- type: entity
  id: RampingStationEventScheduler
  parent: BaseGameRule
  components:
    - type: RampingStationEventScheduler
      scheduledGameRules: !type:NestedSelector
        tableId: BasicGameRulesTable

# variation passes
- type: entity
  id: BasicRoundstartVariation
  parent: BaseGameRule
  components:
    - type: RoundstartStationVariationRule
      rules:
        - id: BasicPoweredLightVariationPass
        - id: BasicTrashVariationPass
        - id: SolidWallRustingVariationPass
        - id: ReinforcedWallRustingVariationPass
        - id: BasicPuddleMessVariationPass
          prob: 0.99
          orGroup: puddleMess
        - id: BloodbathPuddleMessVariationPass
          prob: 0.01
          orGroup: puddleMess
